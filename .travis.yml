language: go

os:
  - linux

go:
  - '1.11'

env:
  global:
    - secure: "PM5fzZ83I1Y+t2edVqQJwvNs7B+7ITGmFTYGlYl7pJGT+8nX07L5o8DI0nGQxE3MrpnZNBS+lRIiJ/R+AC3PI3zCN+fJbPSJH9+IlPii1Kw0bKsRLeup49daDqnVTcsOxLY6qkrLcVwzcSlp6DTOxlSulQwk4zZRG4Uc0OvqsNm1zWaCVn+qUc0b9IlGhtONbhCy1WH4r6ZrN0C0NruptGRrdZMWv2BpygzcPMuS1FQieH9xDkyh7OJYHqroArYlO3lv2HomF0bzQgL+i2zmZ4J6zLpXDfWVQAW0voWXIf3n34F2jhcAC9Efpnq/PMN755FPTgk/+YDVI3IoJthq/lHzPorfLC6pCaW1V7Zhm4s/rp+RAEPXH6p386CCxaXr2x5/tz16daURkkl58ix/IUMMs2MGd9FWHoCslT0WqsEF1H5sf+nFG6tYxxd6dwpzf9KC7p1paXQtu952gKXGi4DioInaJ1R+G+HbSOsFxJiHhDB6Tk8I+Ypohc1ynNX6e9rfIBJhNm6RH4kdJu+1e4MK9dzG1GUomZoh2hUTSradQAwdcKn1sa4EzIHIz2+TwXbyOAXJTofPCr5UN0es/NMLk8Ek38KxvRd0LTLlNWnYnml7UC41IfciHooYrEK+3RIw3eJ6vFMWNxsvrPvV0Rx2MPWcU2tb5YtO9UBnpLg="
    - GITHUB_REPO: "$GIT_USER/$GIT_REPO"

before_install:
  # git config
  - git config --global user.email "$GIT_EMAIL"
  - git config --global user.name "$GIT_NAME"
  - git config --global push.default simple
  # go dependencies
  - GO111MODULE=on go get github.com/gohugoio/hugo

before_script:
  # git
  - git clone "https://github.com/$GITHUB_REPO.git" --branch gh-pages public

script: echo $GIT_EMAIL $GIT_NAME && hugo

after_success:
  - cd public
  - git add --all
  - git commit -m "Publishing to gh-pages from Travis `date`"
  - cd ..
  - git push --force --quiet "https://$GITHUB_TOKEN@github.com/$GITHUB_REPO.git" origin gh-pages

branches:
  only:
    - hugo
    - travis
